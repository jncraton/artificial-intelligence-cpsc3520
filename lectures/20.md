Logistic Regression
===================

Logistic Function
-----------------

$f(x) = \frac{1}{1 + e^{-k(x-x_0)}}$

---

![Logistic Function](https://upload.wikimedia.org/wikipedia/commons/8/88/Logistic-curve.svg)

Fitting
-------

- Least squares is not meaningful for logistic regression
- We are dealing with probilities of events, not a simple value

---

![Logistic Regression Example](https://upload.wikimedia.org/wikipedia/commons/6/6d/Exam_pass_logistic_curve.jpeg)

Maximum Likelihood Estimation
-----------------------------

- We have a set of examples, $X=\{x_1, x_2,...x_n\}$, drawn independently from a data generation probability distribution $p_{data}(x)$

$\theta_{ML} = \underset{\theta}{\operatorname{arg\;max}}\ p_{model}(X; \theta)$

Maximum Likelihood Estimation
-----------------------------

We want to select model parameters that minimize the dissimilarity between our model and our data

---

[More info (section 5.5)](http://www.deeplearningbook.org/contents/ml.html)

Iterative Solving
-----------------

- We fit our model iteratively

---

![Newton's Method](https://upload.wikimedia.org/wikipedia/commons/e/e0/NewtonIteration_Ani.gif)

Nearest Neighbors vs Logistic Regression
----------------------------------------

- Logistic regression simplifies the model to a very small number of parameters (2 per feature)
- Logistic regression is unable to handle data that is not linearly separable

Linear Separability
-------------------

- Points in classes can be separated by a hyperplane
- A hyperplan is simply a space with one less dimension than its ambient space
- A line is a hyperplane of two dimensions, a plane is a hyperplane of 3 dimensions, etc

---

![Linearly separable](https://upload.wikimedia.org/wikipedia/commons/b/b8/VC2.svg)

---

![Not linearly separable](https://upload.wikimedia.org/wikipedia/commons/3/37/VC4.svg)

Apples and Oranges
------------------

```python
import pandas as pd
from sklearn.model_selection import train_test_split
import seaborn as sns

fruits = pd.read_csv("https://exampledata.netlify.app/fruits.csv")

sns.scatterplot(x='mass', y='color_score', data=fruits, hue='fruit_name')
```

---

![Fruits data not linearly separable](media/fruits.png)

Logistic Regression in Python
-----------------------------

```python
from sklearn.linear_model import LogisticRegression

clf = LogisticRegression(max_iter=10000)

clf.fit(X. y)
```
